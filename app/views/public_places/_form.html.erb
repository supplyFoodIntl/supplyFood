<script  type="text/JavaScript">
    function httpGet(theUrl)
    {
    var xmlHttp = null;

    xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, false );
    xmlHttp.send( null );
    return xmlHttp.responseText;
    }
  

function search_by_code(event) {
    var search_text = document.getElementById("search_code").value;
    var search_result_url = "/postal_code_hints_search?search=code&code=" + search_text ;
    document.getElementById("result_search").innerHTML=httpGet(search_result_url);
    event.preventDefault();
    return false;
}
    function search_by_hint(event) {
    var search_text = document.getElementById("search_hint").value;
    var search_result_url = "/postal_code_hints_search?search=hint&hint=" + search_text ;
    document.getElementById("result_search").innerHTML=httpGet(search_result_url);
    event.preventDefault();
    return false;
}
</script>

<%= form_with(model: public_place, local: true,class: "form-horizontal") do |form| %>
  <% if public_place.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(public_place.errors.count, "error") %> prohibited this public_place from being saved:</h2>

      <ul>
      <% public_place.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

    <div class="form-group field">
            <%= form.label :public_place_type_id, class:"control-label" %>
            <%= collection_select( :public_place,:public_place_type_id,  PublicPlaceType.all, :id, :name,  {:prompt => "Select a public place type"}, {:class=>"form-control"} ) %>
    </div>

    <div class="form-group field">
        <%= form.label :name, class:"control-label" %>
        <%= form.text_field :name, placeholder:"Name of the public place", class:"form-control col-sm",id:"search_hint" %>
         <%= link_to "Hint", "", class: 'btn btn-xs btn-success',  onmouseup: "event.preventDefault(); search_by_hint(event);" %>
    </div>

    <div class="form-group field">
        <%= form.label :number %>
        <%= form.text_field :number, placeholder:"number of the public place", class:"form-control col-sm" %>
    </div>
    <% if !public_place.postal_code_hint.nil? %>
        <div id='postal_code_hint'>
            Postal code :
                <%= @public_place.postal_code_hint[:code] %>-
                <%= @public_place.postal_code_hint[:hint] %>

            </table>
        </div>
    <% end %>
    <div class="form-group field">

    </div>

    <div class="">
        <%= form.label "Postal code search" %>
        <%= form.text_field :postal_code_hint_search, class:"form-control col-sm" , id:"search_code" %>
       
        <%= link_to "Search", "", class: 'btn btn-xs btn-success',  onmouseup: "event.preventDefault(); search_by_code(event);" %>
        <div id="result_search"></div>
    </div>


  <div class="actions">
    <%= form.submit %>
  </div>
<% end %>

